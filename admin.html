<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8"><title>ç®¡ç†é¢æ¿</title>
    <style>
        :root {
            --primary-color: #0078d4;
            --background-color: #f3f2f1;
            --surface-color: #ffffff;
            --text-color: #323130;
            --text-color-dark: #605e5c;
            --border-color: #e1dfdd;
            --border-radius: 4px;
            --danger-color: #d92c2c;
            --success-color: #107c10;
            --font-family: 'Microsoft YaHei', 'Segoe UI', system-ui, sans-serif;
            --connected-color: #107c10; --reconnecting-color: #ffc107; --error-color: #d92c2c;
            --shadow-sm: 0 1px 2px 0 rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
        }
        body { font-family: var(--font-family); background-color: var(--background-color); margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; color: var(--text-color); font-size: 14px; -webkit-font-smoothing: antialiased; }
        svg { width: 1em; height: 1em; vertical-align: -0.15em; margin-right: 8px; }
        .titlebar { -webkit-app-region: drag; height: 48px; display: flex; justify-content: space-between; align-items: center; padding: 0 12px 0 20px; background-color: #e6e6e6; border-bottom: 1px solid var(--border-color); flex-shrink: 0; }
        .titlebar-title { -webkit-app-region: no-drag; font-weight: 600; font-size: 16px; display: flex; align-items: center; gap: 10px; }
        .network-indicator { width: 10px; height: 10px; border-radius: 50%; transition: all 0.3s ease; }
        .network-indicator.connected { background-color: var(--connected-color); box-shadow: 0 0 8px var(--connected-color); }
        .network-indicator.reconnecting { background-color: var(--reconnecting-color); animation: pulse 2s infinite; }
        .network-indicator.error { background-color: var(--error-color); }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255,193,7,0.7); } 70% { box-shadow: 0 0 0 10px rgba(255,193,7,0); } 100% { box-shadow: 0 0 0 0 rgba(255,193,7,0); } }
        .window-controls button { -webkit-app-region: no-drag; background: transparent; border: none; width: 36px; height: 36px; color: var(--text-color-dark); cursor: pointer; border-radius: 50%; display: inline-flex; justify-content: center; align-items: center; transition: background-color 0.2s ease; }
        .window-controls button:hover { background-color: rgba(0,0,0,0.1); }
        .window-controls .pin-btn.pinned { color: var(--primary-color); }
        .window-controls .close-btn:hover { background-color: var(--danger-color); color: white; }
        .tab-bar { flex-shrink: 0; background-color: #f9f9f9; padding: 8px 12px 0 12px; border-bottom: 1px solid var(--border-color); display: flex; gap: 8px; }
        .tab-bar button { background: transparent; border: none; border-bottom: 2px solid transparent; padding: 10px 16px; cursor: pointer; font-size: 15px; font-weight: 600; color: var(--text-color-dark); transition: all 0.2s ease; }
        .tab-bar button.active { color: var(--primary-color); border-bottom-color: var(--primary-color); }
        .tab-bar button:hover { background-color: rgba(0,0,0,0.05); }
        .main-content { flex-grow: 1; overflow-y: auto; padding: 16px; }
        .tab-pane { display: none; animation: 0.5s fadeIn; }
        .tab-pane.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; margin-bottom: 16px; }
        .card { background-color: var(--surface-color); border-radius: var(--border-radius); padding: 20px; border: 1px solid var(--border-color); box-shadow: var(--shadow-sm); transition: all 0.2s ease; }
        .card:hover { box-shadow: var(--shadow-md); transform: translateY(-2px); }
        .card h2 { font-size: 18px; margin: 0 0 16px 0; padding-bottom: 12px; border-bottom: 1px solid var(--border-color); display: flex; align-items: center; justify-content: space-between; }
        .stat-card p { font-size: 28px; font-weight: 600; color: var(--primary-color); margin: 8px 0 0 0; }
        .stat-card .label { font-size: 14px; color: var(--text-color-dark); }
        table { width: 100%; border-collapse: collapse; }
        th, td { text-align: left; padding: 12px 10px; border-bottom: 1px solid var(--border-color); }
        th { font-size: 13px; color: var(--text-color-dark); font-weight: 600; background-color: #f9f9f9; }
        tbody tr:nth-child(even) { background-color: #f9f9f9; }
        tbody tr:hover { background-color: #e8f3ff; }
        button, .button { padding: 8px 18px; font-size: 14px; font-weight: 600; border-radius: var(--border-radius); border: 1px solid #ccc; cursor: pointer; background-color: #fff; color: var(--text-color); transition: all 0.2s ease; }
        button.primary, .button.primary { background-color: var(--primary-color); color: white; border-color: var(--primary-color); }
        button:hover, .button:hover { transform: translateY(-1px); box-shadow: var(--shadow-sm); border-color: #a0a0a0; }
        button:active { transform: translateY(0); }
        .actions button { padding: 6px 10px; }
        .form-row { display: flex; flex-direction: column; margin-bottom: 12px; }
        .form-row label { font-weight: 600; margin-bottom: 6px; }
        .form-row input { width: 100%; box-sizing: border-box; padding: 10px; border: 1px solid var(--border-color); border-radius: var(--border-radius); font-size: 14px; }
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 1000; animation: fadeIn 0.3s; }
        .modal.visible { display: flex; }
        .modal-content { padding: 24px; background-color: var(--surface-color); border-radius: var(--border-radius); width: 400px; box-shadow: var(--shadow-md); }
        #toast-container { position: fixed; bottom: 10px; right: 10px; z-index: 200; display: flex; flex-direction: column; gap: 8px; }
        .toast { padding: 10px 15px; background-color: #ffffcc; border: 1px solid #e6db55; color: #333; border-radius: 0; box-shadow: 0 2px 5px rgba(0,0,0,0.2); animation: 0.3s toast-in; display: flex; align-items: center; gap: 8px; }
        .toast.success { background-color: #dff0d8; border-color: #d6e9c6; } .toast.error { background-color: #f2dede; border-color: #ebccd1; }
        @keyframes toast-in { from { opacity: 0; transform: translateX(100%); } to { opacity: 1; transform: translateX(0); } }
    </style>
</head>
<body>
    <svg width="0" height="0" style="display:none;">
        <defs>
            <symbol id="icon-dashboard" viewBox="0 0 24 24"><path fill="currentColor" d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></symbol>
            <symbol id="icon-devices" viewBox="0 0 24 24"><path fill="currentColor" d="M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4V6zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zm-1 10h-4v-8h4v8z"/></symbol>
            <symbol id="icon-users" viewBox="0 0 24 24"><path fill="currentColor" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></symbol>
            <symbol id="icon-stats" viewBox="0 0 24 24"><path fill="currentColor" d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/></symbol>
            <symbol id="icon-add" viewBox="0 0 24 24"><path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></symbol>
            <symbol id="icon-edit" viewBox="0 0 24 24"><path fill="currentColor" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83l3.75 3.75l1.83-1.83z"/></symbol>
            <symbol id="icon-delete" viewBox="0 0 24 24"><path fill="currentColor" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></symbol>
            <symbol id="icon-lock" viewBox="0 0 24 24"><path fill="currentColor" d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2s2 .9 2 2s-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2z"/></symbol>
            <symbol id="icon-unlock" viewBox="0 0 24 24"><path fill="currentColor" d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h2c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2s2 .9 2 2s-.9 2-2 2z"/></symbol>
            <symbol id="icon-reboot" viewBox="0 0 24 24"><path fill="currentColor" d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6s-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8s-3.58-8-8-8z"/></symbol>
            <symbol id="icon-shutdown" viewBox="0 0 24 24"><path fill="currentColor" d="M13 3h-2v10h2V3zm4.83 2.17l-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z"/></symbol>
            <symbol id="icon-success" viewBox="0 0 24 24"><path fill="currentColor" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></symbol>
            <symbol id="icon-error" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></symbol>
        </defs>
    </svg>

    <div class="titlebar">
        <div class="titlebar-title"><svg><use href="#icon-dashboard"/></svg>ç®¡ç†é¢æ¿ - <span id="status">æ­£åœ¨è¿æ¥...</span><div id="network-indicator"></div></div>
        <div class="window-controls"><button id="pin-btn" title="ç½®é¡¶">ğŸ“Œ</button><button id="minimize-btn" title="æœ€å°åŒ–">-</button><button id="maximize-btn" title="æœ€å¤§åŒ–">+</button><button id="close-btn" title="å…³é—­">Ã—</button></div>
    </div>

    <div class="tab-bar">
        <button class="tab-button active" onclick="window.openTab(event, 'dashboard')"><svg><use href="#icon-dashboard"/></svg>æ¦‚è§ˆ & è¥æ”¶</button>
        <button class="tab-button" onclick="window.openTab(event, 'devices')"><svg><use href="#icon-devices"/></svg>è®¾å¤‡ç®¡ç†</button>
        <button class="tab-button" onclick="window.openTab(event, 'users')"><svg><use href="#icon-users"/></svg>ç”¨æˆ· & ç³»ç»Ÿ</button>
    </div>

    <div class="main-content">
        <div id="dashboard" class="tab-pane active">
            <div class="grid-container">
                <div class="card stat-card"><div class="label">åœ¨çº¿è®¾å¤‡æ•°</div><p id="metric-online-clients">0</p></div>
                <div class="card stat-card"><div class="label">ä»Šæ—¥æ€»è¥æ”¶</div><p id="metric-today-revenue">Â¥0.00</p></div>
                <div class="card stat-card"><div class="label">æ³¨å†Œç”¨æˆ·æ•°</div><p id="metric-total-users">0</p></div>
            </div>
            <div class="card">
                <h2><svg><use href="#icon-stats"/></svg>è¥æ”¶ç»Ÿè®¡</h2>
                <div id="stats-controls" style="margin-bottom: 10px;">
                    <button onclick="window.updateStats('today')">ä»Šæ—¥</button>
                    <button onclick="window.updateStats('week')">æœ¬å‘¨</button>
                    <button onclick="window.updateStats('month')">æœ¬æœˆ</button>
                    <button onclick="window.updateStats('all')">å…¨éƒ¨</button>
                </div>
                <div id="stats-grid" class="grid-container"></div>
            </div>
        </div>

        <div id="devices" class="tab-pane">
            <div class="card">
                <h2><svg><use href="#icon-devices"/></svg>å®æ—¶åœ¨çº¿å®¢æˆ·ç«¯</h2>
                <table id="active-clients-table"><thead><tr><th>ç”¨æˆ·å</th><th>ä¸Šæœºæ—¶é—´</th><th>å½“å‰ä½™é¢</th><th>çŠ¶æ€</th><th>æ“ä½œ</th></tr></thead><tbody></tbody></table>
            </div>
        </div>

        <div id="users" class="tab-pane">
            <div class="card">
                <h2><svg><use href="#icon-add"/></svg>ç”¨æˆ·å……å€¼</h2>
                <div class="form-row"><label>ç”¨æˆ·å</label><input id="recharge-username" placeholder="è¦å……å€¼çš„ç”¨æˆ·å"></div>
                <div class="form-row"><label>é‡‘é¢</label><input id="recharge-amount" type="number" placeholder="å……å€¼é‡‘é¢"></div>
                <button onclick="window.recharge()" class="primary">ç¡®è®¤å……å€¼</button>
            </div>
            <div class="card" style="margin-top: 16px;">
                <h2><svg><use href="#icon-users"/></svg>ç”¨æˆ·ç®¡ç† <button class="card-header-action" onclick="window.openUserModal()" title="æ·»åŠ æ–°ç”¨æˆ·"><svg><use href="#icon-add"/></svg>æ·»åŠ </button></h2>
                <table id="all-users-table"><thead><tr><th>ç”¨æˆ·å</th><th>è´¹ç‡ (å…ƒ/å°æ—¶)</th><th>ä½™é¢</th><th>æ“ä½œ</th></tr></thead><tbody></tbody></table>
            </div>
        </div>
    </div>

    <div id="user-modal" class="modal"><div class="modal-content"><h2 id="modal-title"></h2><div class="form-row"><label>ç”¨æˆ·å</label><input id="modal-username"></div><div class="form-row"><label>å¯†ç </label><input id="modal-password" type="password" placeholder="ç•™ç©ºåˆ™ä¸ä¿®æ”¹"></div><div class="form-row"><label>è´¹ç‡</label><input id="modal-rate" type="number" step="0.1"></div><div class="form-actions"><button onclick="window.closeUserModal()">å–æ¶ˆ</button><button class="primary" onclick="window.saveUser()">ä¿å­˜</button></div></div></div>
    <div id="toast-container"></div>

    <script>
    window.addEventListener('DOMContentLoaded', () => {
        const statusEl = document.getElementById('status');
        const indicatorEl = document.getElementById('network-indicator');

        let isEditMode = false, editUsername = null; 
        window.allUsers = {};
        
        const pinBtn = document.getElementById('pin-btn');
        pinBtn.addEventListener('click', async () => pinBtn.classList.toggle('pinned', await window.electronAPI.invoke('toggle-always-on-top')));
        document.getElementById('minimize-btn').addEventListener('click', () => window.electronAPI.send('minimize-window'));
        document.getElementById('maximize-btn').addEventListener('click', () => window.electronAPI.send('maximize-window'));
        document.getElementById('close-btn').addEventListener('click', () => window.electronAPI.send('close-window'));
        pinBtn.classList.add('pinned');

        const userModal = document.getElementById('user-modal');

        window.openTab = (evt, tabName) => {
            Array.from(document.getElementsByClassName('tab-pane')).forEach(p => p.style.display = 'none');
            Array.from(document.getElementsByClassName('tab-button')).forEach(b => b.classList.remove('active'));
            document.getElementById(tabName).style.display = 'block';
            evt.currentTarget.classList.add('active');
        }

        window.showToast = (message, type = 'success') => { 
            const container = document.getElementById('toast-container'); 
            const toast = document.createElement('div'); 
            toast.className = `toast ${type}`;
            toast.innerHTML = `<svg><use href="#icon-${type}"/></svg> ${message}`;
            container.appendChild(toast); 
            setTimeout(() => { toast.remove(); }, 3000); 
        }

        async function apiCall(endpoint, method, body) {
            try {
                const opts = { method, headers: { 'Content-Type': 'application/json' } };
                if (body) opts.body = JSON.stringify(body);
                const response = await fetch(`http://localhost:3000/api${endpoint}`, opts);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                return response.json();
            } catch (error) {
                window.showToast(`è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
                return { success: false, message: `è¯·æ±‚å¤±è´¥: ${error.message}` };
            }
        }

        function updateUI(data) {
            window.allUsers = data.allUsers;
            updateDashboardMetrics(data);
            updateActiveClientsTable(data.clients);
            updateAllUsersTable(data.allUsers);
        }

        function updateDashboardMetrics(data) {
            document.getElementById('metric-online-clients').textContent = data.clients.length;
            document.getElementById('metric-total-users').textContent = Object.keys(data.allUsers).length;
            window.updateStats('today');
        }

        window.updateStats = async (period = 'today') => {
            const result = await apiCall(`/stats?period=${period}`, 'GET');
            if (!result || !result.success) return;
            const { stats } = result;
            const container = document.getElementById('stats-grid');
            container.innerHTML = `
                <div class="card stat-card"><div class="label">æ€»æ”¶å…¥</div><p>Â¥${stats.totalRevenue.toFixed(2)}</p></div>
                <div class="card stat-card"><div class="label">æ€»æ—¶é•¿(åˆ†é’Ÿ)</div><p>${stats.totalDuration}</p></div>
                <div class="card stat-card"><div class="label">æ€»ä¼šè¯</div><p>${stats.totalSessions}</p></div>
            `;
            if (period === 'today') {
                document.getElementById('metric-today-revenue').textContent = `Â¥${stats.totalRevenue.toFixed(2)}`;
            }
        }

        function updateActiveClientsTable(clients) {
            const tbody = document.querySelector('#active-clients-table tbody');
            tbody.innerHTML = clients.length ? '' : '<tr><td colspan="5" style="text-align:center;">æ²¡æœ‰åœ¨çº¿è®¾å¤‡</td></tr>';
            clients.forEach(c => {
                const row = tbody.insertRow();
                row.innerHTML = `<td>${c.username}</td><td>${new Date(c.startTime).toLocaleTimeString()}</td><td>Â¥${(c.balance || 0).toFixed(2)}</td><td>${c.isLocked ? 'å·²é”å®š' : 'åœ¨çº¿'}</td>`;
                const actionsCell = row.insertCell();
                actionsCell.className = 'actions';
                const lockBtn = c.isLocked ? `<button onclick="window.controlClient('${c.username}', 'unlock')"><svg><use href="#icon-unlock"/></svg>è§£é”</button>` : `<button onclick="window.controlClient('${c.username}', 'lock')"><svg><use href="#icon-lock"/></svg>é”å®š</button>`;
                actionsCell.innerHTML = `${lockBtn}<button onclick="window.controlClient('${c.username}', 'reboot')"><svg><use href="#icon-reboot"/></svg>é‡å¯</button><button onclick="window.controlClient('${c.username}', 'shutdown')"><svg><use href="#icon-shutdown"/></svg>å…³æœº</button>`;
            });
        }

        function updateAllUsersTable(users) {
            const tbody = document.querySelector('#all-users-table tbody');
            tbody.innerHTML = Object.keys(users).length ? '' : '<tr><td colspan="4" style="text-align:center;">æ²¡æœ‰ç”¨æˆ·</td></tr>';
            for (const username in users) {
                const user = users[username];
                const row = tbody.insertRow();
                row.innerHTML = `<td>${username}</td><td>${user.rate.toFixed(2)}</td><td>${user.balance.toFixed(2)}</td>`;
                const actionsCell = row.insertCell();
                actionsCell.className = 'actions';
                actionsCell.innerHTML = `<button onclick="window.openUserModal('${username}')"><svg><use href="#icon-edit"/></svg>ç¼–è¾‘</button><button onclick="window.deleteUser('${username}')"><svg><use href="#icon-delete"/></svg>åˆ é™¤</button>`;
            }
        }

        window.controlClient = (username, action) => apiCall(`/control/${username}`, 'POST', { action }).then(res => window.showToast(res.message, res.success ? 'success' : 'error'));
        window.recharge = async () => { const username = document.getElementById('recharge-username').value; const amount = document.getElementById('recharge-amount').value; const result = await apiCall('/recharge', 'POST', { username, amount }); if(result.success) { window.showToast(result.message, 'success'); document.getElementById('recharge-username').value = ''; document.getElementById('recharge-amount').value = ''; } else { window.showToast(result.message, 'error'); } }
        window.deleteUser = async (username) => { if (confirm(`ç¡®å®šåˆ é™¤ ${username}ï¼Ÿ`)) { const result = await apiCall(`/users/${username}`, 'DELETE'); window.showToast(result.message, result.success ? 'success' : 'error'); } }

        window.openUserModal = (username = null) => {
            isEditMode = !!username; editUsername = username;
            document.getElementById('modal-username').disabled = isEditMode;
            document.getElementById('modal-title').textContent = isEditMode ? `ç¼–è¾‘: ${username}` : 'æ·»åŠ ç”¨æˆ·';
            document.getElementById('modal-password').value = '';
            if (isEditMode) { const user = window.allUsers[username]; document.getElementById('modal-username').value = username; document.getElementById('modal-rate').value = user.rate; } 
            else { document.getElementById('modal-username').value = ''; document.getElementById('modal-rate').value = ''; }
            userModal.classList.add('visible');
        }
        window.closeUserModal = () => { userModal.classList.remove('visible'); }
        window.saveUser = async () => {
            const username = document.getElementById('modal-username').value;
            const password = document.getElementById('modal-password').value;
            const rate = document.getElementById('modal-rate').value;
            const body = { rate: parseFloat(rate) };
            if (password) body.password = password;
            if (!isEditMode) body.username = username;
            const result = await apiCall(isEditMode ? `/users/${username}` : '/users', isEditMode ? 'PUT' : 'POST', body);
            if (result.success) { window.closeUserModal(); window.showToast(result.message, 'success'); }
        }

        function connect() {
            let ws = new WebSocket(`ws://localhost:3000`);
            ws.onopen = () => { 
                statusEl.textContent = 'å·²è¿æ¥';
                indicatorEl.className = 'network-indicator connected';
                ws.send(JSON.stringify({ type: 'admin_login' }));
            };
            ws.onmessage = (event) => {
                try {
                    const data = JSON.parse(event.data);
                    if (data.type === 'admin_update') {
                        updateUI(data);
                    }
                } catch (e) {
                    statusEl.textContent = `æ¸²æŸ“é”™è¯¯: ${e.message}`;
                    indicatorEl.className = 'network-indicator error';
                }
            };
            ws.onclose = (event) => { 
                statusEl.textContent = `è¿æ¥å…³é—­ (Code: ${event.code})`;
                indicatorEl.className = 'network-indicator error';
                setTimeout(connect, 5000); 
            };
            ws.onerror = (err) => { 
                statusEl.textContent = 'WebSocketè¿æ¥å¤±è´¥';
                indicatorEl.className = 'network-indicator error';
            };
        }
        connect();
    });
    </script>
</body>
</html>
